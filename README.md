# De-Fake

It is the code for the paper: DE-FAKE: Detection and Attribution of Fake Images Generated by Text-to-Image Generation Models.

### Environment

You first need to build the environment by:
```
conda env create -f environment.yaml
conda activate defake
```

### Infer

For the usage, You can download our model on 

https://drive.google.com/file/d/1qI7x5iodaCFq0S61LKw4wWjql7cYou_4/view?usp=sharing

and

https://drive.google.com/file/d/1SuenxJP10VwArC6zW0SHMUGObMRqQhBD/view?usp=sharing

for the encoder and classifier.

Then test on 

```
python test.py --image_path XXX
```


### Train

If you want to train the detector yourself, please enter the correct file path in train.py.

Then 

```
python train.py
```

